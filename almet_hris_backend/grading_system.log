INFO 2025-10-12 14:41:52,010 views 28000 34492 User info request for user: n.orujova
INFO 2025-10-12 14:41:52,204 views 28000 34492 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 14:41:52,207 views 28000 34492 [n.orujova] User info response prepared successfully
INFO 2025-10-12 15:26:27,910 views 28000 8488 === Microsoft authentication request received ===
INFO 2025-10-12 15:26:27,911 views 28000 8488 Token length: 1274, Graph token: True
INFO 2025-10-12 15:26:27,912 auth 28000 8488 === Starting Microsoft token validation ===
INFO 2025-10-12 15:26:28,248 auth 28000 8488    - Access token length: 228
INFO 2025-10-12 15:26:28,248 auth 28000 8488    - Refresh token length: 229
INFO 2025-10-12 15:27:07,115 views 28000 8488 User info request for user: n.orujova
INFO 2025-10-12 15:27:07,225 views 28000 8488 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 15:27:07,227 views 28000 8488 [n.orujova] User info response prepared successfully
INFO 2025-10-12 15:47:37,913 views 28000 50056 User info request for user: n.orujova
INFO 2025-10-12 15:47:38,018 views 28000 50056 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 15:47:38,020 views 28000 50056 [n.orujova] User info response prepared successfully
INFO 2025-10-12 15:48:41,499 views 28000 50056 User info request for user: n.orujova
INFO 2025-10-12 15:48:41,572 views 28000 50056 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 15:48:41,574 views 28000 50056 [n.orujova] User info response prepared successfully
INFO 2025-10-12 19:35:50,775 views 28000 6812 === Microsoft authentication request received ===
INFO 2025-10-12 19:35:50,776 views 28000 6812 Token length: 1274, Graph token: True
INFO 2025-10-12 19:35:50,777 auth 28000 6812 === Starting Microsoft token validation ===
INFO 2025-10-12 19:35:50,890 auth 28000 6812    - Access token length: 228
INFO 2025-10-12 19:35:50,890 auth 28000 6812    - Refresh token length: 229
INFO 2025-10-12 19:36:01,522 views 28000 6812 User info request for user: n.orujova
INFO 2025-10-12 19:36:01,626 views 28000 6812 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 19:36:01,627 views 28000 6812 [n.orujova] User info response prepared successfully
INFO 2025-10-12 19:36:22,894 views 28000 6812 User info request for user: n.orujova
INFO 2025-10-12 19:36:22,972 views 28000 6812 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 19:36:22,974 views 28000 6812 [n.orujova] User info response prepared successfully
INFO 2025-10-12 19:38:07,084 views 28000 48020 User info request for user: n.orujova
INFO 2025-10-12 19:38:07,181 views 28000 48020 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 19:38:07,183 views 28000 48020 [n.orujova] User info response prepared successfully
INFO 2025-10-12 19:40:45,060 views 28000 32472 User info request for user: n.orujova
INFO 2025-10-12 19:40:45,144 views 28000 32472 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 19:40:45,147 views 28000 32472 [n.orujova] User info response prepared successfully
INFO 2025-10-12 19:41:21,158 views 28000 6812 User info request for user: n.orujova
INFO 2025-10-12 19:41:21,239 views 28000 6812 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 19:41:21,241 views 28000 6812 [n.orujova] User info response prepared successfully
INFO 2025-10-12 19:52:49,487 views 28000 25028 User info request for user: n.orujova
INFO 2025-10-12 19:52:49,569 views 28000 25028 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 19:52:49,570 views 28000 25028 [n.orujova] User info response prepared successfully
INFO 2025-10-12 19:57:20,976 views 28000 12980 User info request for user: n.orujova
INFO 2025-10-12 19:57:21,064 views 28000 12980 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 19:57:21,066 views 28000 12980 [n.orujova] User info response prepared successfully
INFO 2025-10-12 20:04:32,840 views 28000 49804 User info request for user: n.orujova
INFO 2025-10-12 20:04:32,922 views 28000 49804 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 20:04:32,925 views 28000 49804 [n.orujova] User info response prepared successfully
INFO 2025-10-12 20:22:50,792 views 28000 40180 User info request for user: n.orujova
INFO 2025-10-12 20:22:50,866 views 28000 40180 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 20:22:50,867 views 28000 40180 [n.orujova] User info response prepared successfully
INFO 2025-10-12 20:22:57,149 views 28000 12452 User info request for user: n.orujova
INFO 2025-10-12 20:22:57,233 views 28000 12452 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 20:22:57,234 views 28000 12452 [n.orujova] User info response prepared successfully
INFO 2025-10-12 22:18:39,034 views 28000 17844 === Microsoft authentication request received ===
INFO 2025-10-12 22:18:39,037 views 28000 17844 Token length: 1274, Graph token: True
INFO 2025-10-12 22:18:39,038 auth 28000 17844 === Starting Microsoft token validation ===
INFO 2025-10-12 22:18:39,156 auth 28000 17844    - Access token length: 228
INFO 2025-10-12 22:18:39,156 auth 28000 17844    - Refresh token length: 229
INFO 2025-10-12 22:40:17,505 views 28000 49948 User info request for user: n.orujova
INFO 2025-10-12 22:40:17,600 views 28000 49948 [n.orujova] Employee profile found: HLD29
INFO 2025-10-12 22:40:17,604 views 28000 49948 [n.orujova] User info response prepared successfully
INFO 2025-10-13 00:23:24,855 views 28000 35060 User info request for user: n.orujova
INFO 2025-10-13 00:23:25,176 views 28000 35060 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 00:23:25,183 views 28000 35060 [n.orujova] User info response prepared successfully
INFO 2025-10-13 01:49:08,690 views 28000 21360 === Microsoft authentication request received ===
INFO 2025-10-13 01:49:08,694 views 28000 21360 Token length: 1274, Graph token: True
INFO 2025-10-13 01:49:08,695 auth 28000 21360 === Starting Microsoft token validation ===
INFO 2025-10-13 01:49:08,964 auth 28000 21360    - Access token length: 228
INFO 2025-10-13 01:49:08,965 auth 28000 21360    - Refresh token length: 229
INFO 2025-10-13 01:51:54,549 views 28000 24240 User info request for user: n.orujova
INFO 2025-10-13 01:51:54,667 views 28000 24240 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 01:51:54,670 views 28000 24240 [n.orujova] User info response prepared successfully
INFO 2025-10-13 01:53:20,014 views 28000 10100 User info request for user: n.orujova
INFO 2025-10-13 01:53:20,166 views 28000 10100 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 01:53:20,168 views 28000 10100 [n.orujova] User info response prepared successfully
INFO 2025-10-13 02:00:02,275 views 28000 49036 User info request for user: n.orujova
INFO 2025-10-13 02:00:02,385 views 28000 49036 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 02:00:02,387 views 28000 49036 [n.orujova] User info response prepared successfully
INFO 2025-10-13 02:07:55,823 views 28000 19252 User info request for user: n.orujova
INFO 2025-10-13 02:07:55,961 views 28000 19252 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 02:07:55,964 views 28000 19252 [n.orujova] User info response prepared successfully
INFO 2025-10-13 09:51:39,410 views 28000 41648 === Microsoft authentication request received ===
INFO 2025-10-13 09:51:39,411 views 28000 41648 Token length: 1274, Graph token: True
INFO 2025-10-13 09:51:39,412 auth 28000 41648 === Starting Microsoft token validation ===
INFO 2025-10-13 09:51:39,561 auth 28000 41648    - Access token length: 228
INFO 2025-10-13 09:51:39,561 auth 28000 41648    - Refresh token length: 229
INFO 2025-10-13 10:05:49,814 views 28000 6648 User info request for user: n.orujova
INFO 2025-10-13 10:05:49,920 views 28000 6648 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 10:05:49,922 views 28000 6648 [n.orujova] User info response prepared successfully
INFO 2025-10-13 10:16:07,977 views 28000 16604 User info request for user: n.orujova
INFO 2025-10-13 10:16:08,110 views 28000 16604 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 10:16:08,112 views 28000 16604 [n.orujova] User info response prepared successfully
INFO 2025-10-13 10:21:10,556 views 28000 34468 User info request for user: n.orujova
INFO 2025-10-13 10:21:10,652 views 28000 34468 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 10:21:10,654 views 28000 34468 [n.orujova] User info response prepared successfully
INFO 2025-10-13 10:21:50,636 views 28000 47612 User info request for user: n.orujova
INFO 2025-10-13 10:21:50,737 views 28000 47612 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 10:21:50,738 views 28000 47612 [n.orujova] User info response prepared successfully
INFO 2025-10-13 10:26:14,606 views 28000 34468 User info request for user: n.orujova
INFO 2025-10-13 10:26:14,686 views 28000 34468 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 10:26:14,687 views 28000 34468 [n.orujova] User info response prepared successfully
INFO 2025-10-13 10:31:43,077 views 28000 48352 User info request for user: n.orujova
INFO 2025-10-13 10:31:43,158 views 28000 48352 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 10:31:43,159 views 28000 48352 [n.orujova] User info response prepared successfully
INFO 2025-10-13 10:47:55,078 views 28000 9728 User info request for user: n.orujova
INFO 2025-10-13 10:47:55,188 views 28000 9728 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 10:47:55,193 views 28000 9728 [n.orujova] User info response prepared successfully
INFO 2025-10-13 11:07:04,798 views 28000 41408 User info request for user: n.orujova
INFO 2025-10-13 11:07:04,930 views 28000 41408 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 11:07:04,932 views 28000 41408 [n.orujova] User info response prepared successfully
INFO 2025-10-13 11:18:55,473 views 28000 2228 User info request for user: n.orujova
INFO 2025-10-13 11:18:55,693 views 28000 2228 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 11:18:55,698 views 28000 2228 [n.orujova] User info response prepared successfully
INFO 2025-10-13 11:24:33,894 views 12748 23204 User info request for user: n.orujova
INFO 2025-10-13 11:24:34,108 views 12748 23204 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 11:24:34,113 views 12748 23204 [n.orujova] User info response prepared successfully
WARNING 2025-10-13 11:24:52,651 notification_views 12748 12788 Email notifications will be skipped or require manual token
INFO 2025-10-13 11:30:34,700 views 42156 20244 User info request for user: n.orujova
INFO 2025-10-13 11:30:34,840 views 42156 20244 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 11:30:34,844 views 42156 20244 [n.orujova] User info response prepared successfully
WARNING 2025-10-13 11:30:45,430 notification_views 42156 16604 No Graph token for user n.orujova
INFO 2025-10-13 11:31:25,315 views 42156 39852 User info request for user: n.orujova
INFO 2025-10-13 11:31:25,452 views 42156 39852 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 11:31:25,455 views 42156 39852 [n.orujova] User info response prepared successfully
INFO 2025-10-13 11:31:41,938 views 42156 20244 === Microsoft authentication request received ===
INFO 2025-10-13 11:31:41,938 views 42156 20244 Token length: 1274, Graph token: True
INFO 2025-10-13 11:31:41,939 auth 42156 20244 === Starting Microsoft token validation ===
INFO 2025-10-13 11:31:42,068 auth 42156 20244    - Access token length: 228
INFO 2025-10-13 11:31:42,068 auth 42156 20244    - Refresh token length: 229
INFO 2025-10-13 11:32:40,239 notification_views 42156 7408 Searching emails with filter: [BUSINESS TRIP]
ERROR 2025-10-13 11:32:40,240 notification_views 42156 7408 Error getting Outlook emails: 'NotificationService' object has no attribute 'get_emails_by_subject'
ERROR 2025-10-13 11:32:40,242 notification_views 42156 7408 Traceback (most recent call last):
  File "C:\Users\NarminOrujova\OneDrive - Almet Holding CJSC\Desktop\backend\almet_hris_backend\api\notification_views.py", line 329, in get_outlook_business_trip_emails
    emails = notification_service.get_emails_by_subject(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NotificationService' object has no attribute 'get_emails_by_subject'

INFO 2025-10-13 11:34:41,423 views 38440 3536 User info request for user: n.orujova
INFO 2025-10-13 11:34:41,614 views 38440 3536 [n.orujova] Employee profile found: HLD29
INFO 2025-10-13 11:34:41,624 views 38440 3536 [n.orujova] User info response prepared successfully
INFO 2025-10-13 11:40:39,339 notification_service 38440 17012 Using Graph token: eyJ0eXAiOi...n0_VV0BXRQ
INFO 2025-10-13 11:40:39,388 notification_service 38440 17012    Subject: [BUSINESS TRIP] Request #BT20250008 - Pending Your Approval
INFO 2025-10-13 11:40:40,227 notification_service 38440 17012 Graph API response: 202
INFO 2025-10-13 11:40:48,322 notification_service 38440 31784 Using Graph token: eyJ0eXAiOi...n0_VV0BXRQ
INFO 2025-10-13 11:40:48,336 notification_service 38440 31784    Subject: [BUSINESS TRIP] Request #BT20250008 - Line Manager Approved - Pending Finance Approval
INFO 2025-10-13 11:40:49,097 notification_service 38440 31784 Graph API response: 202
INFO 2025-10-13 11:41:44,623 notification_views 38440 49596 Searching emails with filter: [BUSINESS TRIP]
ERROR 2025-10-13 11:41:44,624 notification_views 38440 49596 Error getting Outlook emails: 'NotificationService' object has no attribute 'get_emails_by_subject'
ERROR 2025-10-13 11:41:44,626 notification_views 38440 49596 Traceback (most recent call last):
  File "C:\Users\NarminOrujova\OneDrive - Almet Holding CJSC\Desktop\backend\almet_hris_backend\api\notification_views.py", line 329, in get_outlook_business_trip_emails
    emails = notification_service.get_emails_by_subject(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NotificationService' object has no attribute 'get_emails_by_subject'

INFO 2025-10-13 11:44:19,231 notification_views 33464 46892 Searching emails with filter: [BUSINESS TRIP]
INFO 2025-10-13 11:44:19,835 notification_service 33464 46892 Graph API response: 400
ERROR 2025-10-13 11:44:19,835 notification_service 33464 46892 Response body: {"error":{"code":"InefficientFilter","message":"The restriction or sort order is too complex for this operation."}}
ERROR 2025-10-13 11:44:19,836 notification_service 33464 46892 Failed to get emails: 400 - {"error":{"code":"InefficientFilter","message":"The restriction or sort order is too complex for this operation."}}
INFO 2025-10-13 11:45:12,290 notification_service 33464 30852 Using Graph token: eyJ0eXAiOi...n0_VV0BXRQ
INFO 2025-10-13 11:45:12,307 notification_service 33464 30852    Subject: [BUSINESS TRIP] Request #BT20250008 - Finance Approved - Pending HR Processing
INFO 2025-10-13 11:45:13,057 notification_service 33464 30852 Graph API response: 202
INFO 2025-10-13 11:47:21,952 notification_views 45692 39952 Searching emails with filter: [BUSINESS TRIP]
INFO 2025-10-13 11:47:21,956 notification_service 45692 39952    Filter query: contains(subject, '[BUSINESS TRIP]')
INFO 2025-10-13 11:47:22,555 notification_service 45692 39952 Graph API response: 400
ERROR 2025-10-13 11:47:22,557 notification_service 45692 39952 Response body: {"error":{"code":"InefficientFilter","message":"The restriction or sort order is too complex for this operation."}}
ERROR 2025-10-13 11:47:22,558 notification_service 45692 39952 Failed to get emails: 400 - {"error":{"code":"InefficientFilter","message":"The restriction or sort order is too complex for this operation."}}
